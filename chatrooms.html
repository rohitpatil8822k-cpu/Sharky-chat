<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0,user-scalable=no" />
  
  <title>Sharky Chat | Free Live Chat Rooms List - Join a Room Now</title>
  
  <meta name="description" content="Explore and join the best free live chat rooms on Sharky Chat. Find groups for dating, talking to strangers, or casual conversation. Secure, real-time access to global rooms." />
  
  <meta name="keywords" content="Sharky chat rooms, live chat rooms, free group chat, join chat rooms, list of chat rooms, real-time chat, free chat, group chat, chat rooms list, anonymous chat rooms, meet people, secure chat, best chat rooms" />
  
  <meta name="author" content="Sharky Chat Team" />
  <meta name="robots" content="index,follow" />
  <link rel="canonical" href="https://sharkychat.com/chatrooms.html" />

  <link rel="icon" href="/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" sizes="180x180" href="/logo.png" />
  <link rel="icon" type="image/png" sizes="192x192" href="/logo.png" />
  <meta name="theme-color" content="#2c2c2c" />
  <link rel="manifest" href="/manifest.json" />

  <meta property="og:title" content="Sharky Chat Rooms: Live Group Chat & Meet People" />
  <meta property="og:description" content="Browse available live chat rooms on Sharky Chat. Click to join and start chatting instantly with users worldwide!" />
  <meta property="og:image" content="https://sharkychat.com/logo.png" />
  <meta property="og:url" content="https://sharkychat.com/chatrooms.html" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Sharky Chat" /> 
  
  <meta name="twitter:card" content="summary" /> 
  <meta name="twitter:title" content="Sharky Chat Rooms | Find Your Group Chat" />
  <meta name="twitter:description" content="The best place to find and join active chat rooms. Talk to strangers, make friends, and more. Join a room now!" />
  <meta name="twitter:image" content="https://sharkychat.com/logo.png" />

  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Sharky Chat",
      "url": "https://sharkychat.com",
      "description": "A real-time chatroom and social networking website for meeting strangers, dating, and engaging in fun online conversations.",
      "potentialAction": {
        "@type": "SearchAction",
        "target": {
          "@type": "EntryPoint",
          "urlTemplate": "https://sharkychat.com/search?q={search_term_string}"
        },
        "query-input": "required name=search_term_string"
      },
      "image": "https://sharkychat.com/logo.png" 
    }
  </script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Roboto&family=Poppins:wght@600&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron&display=swap" rel="stylesheet"/>
  <style>
    html {
      scroll-behavior: smooth;
    }
    body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      background: linear-gradient(145deg, #2c2c2c, #3b3b3b);
      color: #d1d1d1;
      font-family: 'Roboto', Arial, Helvetica, sans-serif;
      overflow-x: hidden;
      display: flex;
      flex-direction: column;
      user-select: none;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    body.light-theme {
        background: linear-gradient(145deg, #f0f0f0, #e0e0e0);
        color: #333;
    }
    body.light-theme main {
        background: none;
    }
    body.light-theme h1 {
        color: #444444;
        text-shadow:
            0 0 6px #555555aa,
            0 0 12px #333333cc;
    }
    body.light-theme header {
        background: #fcfcfc;
        box-shadow: 0 2px 18px #0000001a;
        color: #444;
    }
    body.light-theme .logo-text {
        color: #555;
        text-shadow: 0 0 7px #7777777a;
    }
    body.light-theme .menu-btn {
        color: #666;
        filter: drop-shadow(0 0 3px #999999aa);
    }
    body.light-theme .menu-btn:active {
        background: #e0e0e0;
    }
    body.light-theme .menu-dropdown {
        background: rgba(255, 255, 255, 0.96);
        box-shadow: -4px 0 26px rgba(0, 0, 0, 0.2);
        color: #333;
    }
    body.light-theme .menu-dropdown .close-btn {
        color: #555;
    }
    body.light-theme .menu-dropdown a {
        color: #555;
        border-bottom: 2px solid #ccc;
    }
    body.light-theme .menu-dropdown a:hover,
    body.light-theme .menu-dropdown a:focus {
        background: #e9e9e9;
        color: #000;
    }
    body.light-theme .menu-dropdown a .icon {
        fill: #555;
        filter: drop-shadow(0 1px 6px #55555566);
    }
    body.light-theme .room {
        background: linear-gradient(145deg, #ffffff, #f0f0f0);
        box-shadow:
            0 4px 12px rgba(0,0,0,0.1),
            inset 0 0 12px rgba(220,220,220,0.3);
        color: #555;
    }
    body.light-theme .room:hover {
        box-shadow:
            0 16px 26px rgba(0,0,0,0.15),
            inset 0 0 16px rgba(100,100,100,0.15);
        background-color: #f7f7f7;
        color: #000;
    }
    body.light-theme .room-title {
        color: #333;
        text-shadow: 0 0 4px #bbbbbb;
    }
    body.light-theme .user-count {
        color: #777;
        text-shadow: 0 0 2px #d0d0d0;
    }
    body.light-theme .room-icon {
        color: #778899;
        filter: drop-shadow(0 0 3px #9aaabbcc);
    }
    body.light-theme .room:hover .room-icon {
        color: #445566;
    }
    body.light-theme #loaderOverlay {
        background: rgba(255, 255, 255, 0.95);
        color: #555;
    }
    body.light-theme .rotator {
        border: 5px solid #cccccc;
        border-top: 5px solid #666666;
        filter: drop-shadow(0 0 8px #999999cc);
    }
    body.light-theme footer {
        color: #777;
    }
    body.light-theme footer a {
        color: #555;
    }
    body.light-theme footer a:hover {
        color: #333;
    }
    body.light-theme #topBannerAd {
        background: #e9e9e9;
    }


    main {
      flex-grow: 1;
      width: 100vw;
      max-width: 580px;
      padding: 90px 20px 20px; /* Adjusted bottom padding */
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      gap: 28px;
      animation: fadeInSlide 0.8s cubic-bezier(0.46, 0.03, 0.52, 0.96) forwards;
      margin: 0 auto;
      user-select: text;
    }
    @keyframes fadeInSlide {
      0% {
        opacity: 0;
        transform: translateY(14px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }
    h1 {
      font-family: 'Orbitron', monospace, sans-serif;
      font-weight: 700;
      font-size: 1.6rem;
      letter-spacing: 2px;
      color: #a9a9a9;
      text-shadow:
        0 0 6px #b0b0b0aa,
        0 0 12px #7f7f7fcc;
      text-align: center;
      margin: 0 0 14px;
    }
    #roomList {
      display: flex;
      flex-direction: column;
      gap: 20px;
      width: 100%;
      min-height: 80px;
      pointer-events: auto;
    }
    .room {
      background: linear-gradient(145deg, #3a3a3a, #2e2e2e);
      border-radius: 14px;
      box-shadow:
        0 4px 12px rgba(150,150,150,0.25),
        inset 0 0 12px rgba(125,125,125,0.3);
      padding: 15px 18px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 14px;
      color: #b8b8b8;
      font-weight: 600;
      font-size: 1.1rem;
      transition:
        transform 0.35s cubic-bezier(0.4, 0, 0.2, 1),
        box-shadow 0.35s cubic-bezier(0.4, 0, 0.2, 1),
        background-color 0.4s ease,
        color 0.3s ease;
      overflow: hidden;
      position: relative;
      will-change: transform;
      perspective: 550px;
    }
    .room:active {
      transform: scale(0.95) rotateX(8deg) rotateZ(-2deg);
      box-shadow:
        0 6px 18px rgba(255,255,255,0.2),
        inset 0 0 14px rgba(200,200,200,0.4);
    }
    .room-icon {
      flex-shrink: 0;
      font-size: 22px;
      color: #9aaabb;
      filter: drop-shadow(0 0 3px #899bbbcc);
      transition: color 0.4s ease;
    }
    .room-info {
      flex-grow: 1;
      overflow: hidden;
    }
    .room-title {
      white-space: nowrap;
      overflow-x: auto;
      scrollbar-width: none;
      color: #d3d3d3;
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      font-size: 1.12rem;
      margin-bottom: 3px;
      text-shadow: 0 0 4px #707070aa;
    }
    .room-title::-webkit-scrollbar {
      display: none;
    }
    .user-count {
      font-size: 0.92rem;
      color: #999999;
      font-weight: 400;
      font-family: 'Roboto', sans-serif;
      text-shadow: 0 0 2px #5a5a5aaa;
    }
    .room:hover {
      transform: scale(1.08) translateY(-4px) rotateZ(-1deg);
      box-shadow:
        0 16px 26px rgba(200,200,200,0.45),
        inset 0 0 16px rgba(220,220,220,0.55);
      background-color: #444444;
      color: #e7e7e7;
    }
    .room:hover .room-icon {
      color: #ccddee;
    }
    #loaderOverlay {
      position: fixed;
      z-index: 101;
      left: 0; top: 0; width: 100vw; height: 100vh;
      background: rgba(46, 46, 46, 0.95);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      font-family: 'Orbitron', monospace, sans-serif;
      font-size: 1.3rem;
      color: #b0b0b0;
      letter-spacing: 1.5px;
      transition: opacity 0.4s ease;
      pointer-events: all;
    }
    .rotator {
      border: 5px solid #5a5a5a;
      border-top: 5px solid #bbbbbb;
      border-radius: 50%;
      width: 54px; height: 54px;
      animation: spin 1.3s cubic-bezier(0.45, 0, 0.55, 1) infinite;
      margin-bottom: 24px;
      filter: drop-shadow(0 0 8px #cdd5dfcc);
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Esport Lobby Button Styles */
    #extraNav {
        max-width: 580px;
        width: 100%;
        margin: 0 auto;
        padding: 0 20px;
        box-sizing: border-box;
        display: flex;
        justify-content: center;
        margin-top: 20px; /* Space after the last chat room */
        margin-bottom: 30px; /* Space before the footer */
    }
    .lobby-btn {
        display: block;
        width: 80%;
        max-width: 300px;
        text-align: center;
        padding: 12px 18px;
        border-radius: 10px;
        font-family: 'Orbitron', monospace;
        font-size: 1.1rem;
        font-weight: 700;
        text-transform: uppercase;
        text-decoration: none;
        color: #fff;
        background: linear-gradient(135deg, #007bff 0%, #00c7e2 100%);
        border: 2px solid #00c7e2;
        box-shadow: 
          0 0 8px rgba(0, 199, 226, 0.6), 
          0 3px 12px rgba(0, 0, 0, 0.4);
        transition: 
          transform 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94), 
          box-shadow 0.2s, 
          background 0.2s,
          opacity 0.4s ease-out, /* Added opacity transition */
          transform 0.4s ease-out; /* Added transform transition */
        position: relative;
        overflow: hidden;
        z-index: 10;
        letter-spacing: 1px;
        opacity: 0; /* Initially hidden */
        transform: translateY(20px);
    }
    .lobby-btn.loaded {
        opacity: 1;
        transform: translateY(0);
    }
    .lobby-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.2);
        transform: skewX(-30deg);
        transition: all 0.5s;
        z-index: 0;
    }
    .lobby-btn:hover::before {
        left: 100%;
    }
    .lobby-btn:active {
        transform: scale(0.98);
        box-shadow: 
          0 0 15px rgba(0, 199, 226, 0.9), 
          0 2px 8px rgba(0, 0, 0, 0.6);
        background: linear-gradient(135deg, #0060c0 0%, #0099ad 100%);
    }
    .lobby-btn span {
        position: relative;
        z-index: 2;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
    }
    .lobby-btn svg {
        width: 18px;
        height: 18px;
        stroke: #fff;
        stroke-width: 2.5;
        filter: drop-shadow(0 0 3px #fff);
    }
    .lobby-btn-anim {
        animation: neonGlow 0.5s ease-out;
        pointer-events: none;
    }
    @keyframes neonGlow {
        0% { transform: scale(1); box-shadow: 0 0 8px #00c7e2; }
        50% { transform: scale(1.03) rotateZ(1deg); box-shadow: 0 0 20px #00c7e2, 0 0 30px #007bff; }
        100% { transform: scale(1); box-shadow: 0 0 10px rgba(0, 199, 226, 0.6); }
    }


    footer {
      text-align: center;
      font-size: 0.91rem;
      color: #999999;
      padding: 14px 10px 32px 10px;
      background: transparent;
      max-width: 580px;
      width: 100vw;
      user-select: none;
      margin: 0 auto;
    }
    footer a {
      color: #b0b0b0;
      margin: 0 14px;
      text-decoration: none;
      font-weight: 600;
      transition: color 0.3s ease;
    }
    footer a:hover {
      text-decoration: underline;
      color: #dddddd;
    }

    /* Header styles */
    header {
      background: #2e2e2e;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 2000;
      width: 100vw;
      box-shadow: 0 2px 18px #00000085;
      min-height: 50px;
      user-select: none;
      transition: box-shadow 0.23s;
      color: #bbbbbb;
      font-family: "Poppins", Arial, sans-serif;
    }
    .header-inner {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 16px;
      min-height: 50px;
      position: relative;
      z-index: 1;
      font-size: 1.02rem;
      color: inherit;
    }
    .logo-container {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .logo-container img {
      height: 25px;
      animation: float 3.3s ease-in-out infinite;
      user-select: none;
      pointer-events: none;
      filter: drop-shadow(0 0 5px #999999aa);
      mix-blend-mode: screen;
    }
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-4px); }
    }
    .logo-text {
      font-family: "Orbitron", Arial, Helvetica, sans-serif;
      font-size: 1.02rem;
      color: #adadad;
      text-shadow: 0 0 7px #ababab7a;
      font-weight: 800;
      letter-spacing: 0.055em;
      user-select: none;
    }
    .menu-btn {
      font-size: 1.5rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      min-width: 38px;
      height: 36px;
      color: #cccccc;
      outline: none;
      border: none;
      background: none;
      border-radius: 9px;
      position: relative;
      transition: background 0.21s ease, transform 0.21s ease;
      user-select: none;
      filter: drop-shadow(0 0 3px #bbbbbbaa);
    }
    .menu-btn:active {
      background: #444444;
      transform: scale(0.95);
    }
    .menu-btn .notif-badge {
      background: linear-gradient(105deg, #ff6b6b 65%, #ffa45c 110%);
      color: white;
      font-weight: 700;
      font-family: "Orbitron", monospace;
      min-width: 14px;
      height: 14px;
      padding: 0 7px;
      font-size: 12px;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      position: absolute;
      top: 2px;
      right: 2px;
      border: 1px solid #2e2e2e;
      box-shadow: 0 2px 6px #ef444488;
      pointer-events: none;
      z-index: 10;
      user-select: none;
    }
    .menu-dropdown {
      position: fixed;
      top: 0;
      right: -100%;
      height: 100vh;
      width: 220px;
      background: rgba(50, 50, 50, 0.96);
      box-shadow: -4px 0 26px rgba(0, 0, 0, 0.77);
      padding-top: 54px;
      padding-bottom: 22px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      font-family: "Poppins", Arial, sans-serif;
      font-weight: 600;
      font-size: 0.85rem;
      overflow-y: auto;
      transition: right 0.31s cubic-bezier(0.65, 0.01, 0.32, 1.03);
      z-index: 2500;
      user-select: none;
      color: #c1c1c1;
    }
    header.expanded .menu-dropdown {
      right: 0;
    }
    .menu-dropdown .close-btn {
      position: absolute;
      left: 11px;
      top: 13px;
      background: transparent;
      border: none;
      cursor: pointer;
      padding: 0;
      outline: none;
      z-index: 2600;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.2s ease;
      color: #adadad;
      user-select: none;
    }
    .menu-dropdown .close-btn:hover,
    .menu-dropdown .close-btn:focus {
      color: #d3d3d3;
      transform: scale(1.22);
    }
    .menu-dropdown .close-btn svg {
      width: 22px;
      height: 22px;
      stroke: currentColor;
      stroke-width: 2.5;
      stroke-linecap: round;
      stroke-linejoin: round;
      user-select: none;
    }
    .menu-dropdown a {
      color: #b0b0b0;
      padding: 13px 17px 13px 46px;
      text-decoration: none;
      border-bottom: 2px solid #404040;
      display: flex;
      align-items: center;
      gap: 15px;
      background: none;
      transition: background 0.13s, color 0.13s, padding-left 0.11s, transform 0.16s;
      letter-spacing: 0.02em;
      user-select: none;
      font-weight: 600;
      font-size: 0.85rem;
      will-change: transform;
      position: relative;
    }
    .menu-dropdown a:hover,
    .menu-dropdown a:focus {
      background: #505050;
      color: #ffffff;
      padding-left: 51px;
      outline: none;
      transform: scale(1.05) translateX(-2px);
    }
    .menu-dropdown a:active {
      background: #3a3a3a;
      color: #ffc107;
      transform: scale(0.97);
    }
    .menu-dropdown .notif-badge {
      position: static;
      margin-left: 7px;
      box-shadow: none;
      border: none;
      font-weight: 700;
      font-family: "Orbitron", monospace;
      font-size: 13px;
      min-width: 22px;
      height: 18px;
      background: linear-gradient(120deg, #e0d524 70%, #ff6b6b 100%);
      color: #222b3a;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: 7px;
      user-select: none;
    }
    .menu-dropdown a .icon {
      display: inline-flex;
      width: 22px;
      height: 22px;
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      fill: #b0b0b0;
      filter: drop-shadow(0 1px 6px #b0b0b066);
      transition: fill 0.13s, filter 0.11s;
      user-select: none;
    }
    .menu-dropdown a:hover .icon,
    .menu-dropdown a:focus .icon {
      fill: #fff;
      filter: drop-shadow(0 2px 8px #fff4);
    }


    .room-animate-click {
      animation: roomClickAnim 0.7s ease forwards;
      pointer-events: none;
      position: relative;
      z-index: 1000;
    }
    @keyframes roomClickAnim {
      0% {
        box-shadow: 0 0 14px 4px #a4beff88;
        transform: scale(1);
      }
      50% {
        box-shadow: 0 0 30px 12px #7da5ffbb;
        transform: scale(1.06) rotateZ(1deg);
      }
      100% {
        box-shadow: 0 0 6px 2px #637dad66;
        transform: scale(1) rotate(0);
        opacity: 0.85;
      }
    }

    .flower {
      pointer-events: none;
      position: absolute;
      width: 16px;
      height: 16px;
      background: radial-gradient(circle, #b2dffc, #799edb);
      border-radius: 50% 50% 50% 50% / 70% 70% 30% 30%;
      filter: drop-shadow(0 0 3px #a9c6ffcc);
      animation: flowerRise 1200ms ease forwards;
      opacity: 1;
      transform-origin: center bottom;
      mix-blend-mode: screen;
      z-index: 1200;
    }
    @keyframes flowerRise {
      0% {
        opacity: 1;
        transform: translateY(0) scale(0.85) rotate(0deg);
      }
      100% {
        opacity: 0;
        transform: translateY(-90px) scale(1.3) rotate(360deg);
      }
    }

    #topBannerAd {
        width: 100%;
        max-width: 728px;
        min-height: 90px;
        margin: 10px auto 20px auto;
        display: flex;
        justify-content: center;
        align-items: center;
        background: #252525;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0,0,0,0.5);
    }
    body.light-theme #topBannerAd {
        background: #e9e9e9;
    }
    @media (max-width: 768px) {
        #topBannerAd {
            max-width: 100%;
            height: auto;
            min-height: 50px;
        }
    }


    @media (max-width: 600px) {
      main {
        padding: 90px 14px 20px;
        gap: 22px;
      }
      .room {
        font-size: 1rem;
        padding: 13px 15px;
        gap: 12px;
      }
      .room-title {
        font-size: 1rem;
      }
      h1 {
        font-size: 1.38rem;
        letter-spacing: 1.5px;
      }
      footer {
        font-size: 0.85rem;
        padding: 12px 8px 28px;
      }
      footer a {
        margin: 0 10px;
        font-size: 0.9rem;
      }
      .lobby-btn {
        font-size: 1rem;
        padding: 10px 15px;
        max-width: 250px;
      }
      .lobby-btn svg {
        width: 16px;
        height: 16px;
      }
    }
    @media (max-width: 400px) {
      main {
        padding: 90px 10px 20px;
        gap: 18px;
      }
      h1 {
        font-size: 1.14rem;
      }
    }
    
  </style>
</head>
<body>
  <header id="mainHeader">
    <div class="header-inner">
      <div class="logo-container">
        <img src="https://firebasestorage.googleapis.com/v0/b/sharky-chat-007.firebasestorage.app/o/gc-logo.png?alt=media&token=ddfe6e46-7351-4a07-8140-ea702b1bd823" alt="Sharky Logo" />
        <div class="logo-text">SHARKY CHAT</div>
      </div>
      <button class="menu-btn" id="menuBtn" type="button" aria-label="Toggle menu">
        â˜°
        <span class="notif-badge" id="menuNotif" style="display:none;">0</span>
      </button>
    </div>
    <nav class="menu-dropdown" role="menu" aria-label="Main Navigation">
      <button class="close-btn" aria-label="Close menu" title="Close menu">
        <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <line x1="18" y1="6" x2="6" y2="18" />
          <line x1="6" y1="6" x2="18" y2="18" />
        </svg>
      </button>
      <a href="profile.html" role="menuitem"><span class="icon"><svg viewBox="0 0 32 32"><circle cx="16" cy="12" r="7"/><ellipse cx="16" cy="23.5" rx="12" ry="6.5"/></svg></span>Profile</a>
      <a href="chatrooms.html" role="menuitem"><span class="icon"><svg viewBox="0 0 32 32"><rect x="2" y="8" width="28" height="16" rx="5"/><rect x="12" y="6" width="8" height="4" rx="2"/><circle cx="7" cy="12" r="2"/><circle cx="25" cy="12" r="2"/></svg></span>Chat Rooms</a>
      <a href="friends.html" role="menuitem">
        <span class="icon"><svg viewBox="0 0 32 32"><circle cx="10" cy="12" r="5"/><circle cx="22" cy="12" r="5"/><ellipse cx="16" cy="23" rx="12" ry="6"/></svg></span>Friends
        <span id="friends-notif" class="notif-badge" style="display:none;">0</span>
      </a>
      <a href="add-friends.html" role="menuitem"><span class="icon"><svg viewBox="0 0 32 32"><circle cx="15" cy="13" r="7"/><rect x="23" y="19" width="9" height="3" rx="1.5"/><rect x="26" y="16" width="3" height="9" rx="1.5"/></svg></span>Add Friend</a>
      <a href="inbox.html" role="menuitem">
        <span class="icon"><svg viewBox="0 0 32 32"><rect x="4" y="8" width="24" height="16" rx="4"/><polyline points="4,8 16,18 28,8" fill="none" stroke="#60a5fa" stroke-width="2"/></svg></span>Messages
        <span id="messages-notif" class="notif-badge" style="display:none;">0</span>
      </a>
      <a href="wallet.html" role="menuitem">
        <span class="icon"><svg viewBox="0 0 32 32"><rect x="4" y="10" width="24" height="12" rx="3"/><ellipse cx="24" cy="16" rx="2" ry="2"/><rect x="6" y="13" width="20" height="4" rx="2"/><circle cx="17" cy="16" r="2" fill="#fff"/></svg></span>Wallet
        <span id="wallet-notif" class="notif-badge" style="display:none;">0</span>
      </a>
      <a href="shop.html" role="menuitem"><span class="icon"><svg viewBox="0 0 32 32"><rect x="6" y="13" width="20" height="9" rx="3"/><rect x="12" y="7" width="8" height="6" rx="2"/><rect x="13" y="22" width="6" height="4" rx="2"/><circle cx="10" cy="26" r="2"/><circle cx="22" cy="26" r="2"/></svg></span>Shop</a>
      <a href="inventory.html" role="menuitem"><span class="icon"><svg viewBox="0 0 32 32"><rect x="7" y="10" width="18" height="12" rx="3"/><rect x="11" y="6" width="10" height="4" rx="2"/><rect x="13" y="22" width="6" height="4" rx="2"/><path d="M7 22h18"/><circle cx="16" cy="18" r="2"/></svg></span>Inventory</a>
      <a href="news.html" role="menuitem"><span class="icon"><svg viewBox="0 0 32 32"><rect x="5" y="7" width="22" height="18" rx="4"/><rect x="9" y="11" width="14" height="2" rx="1"/><rect x="9" y="16" width="8" height="2" rx="1"/><circle cx="10" cy="21" r="2"/><rect x="14" y="20" width="7" height="2" rx="1"/></svg></span>News</a>
      <a href="level.html" role="menuitem"><span class="icon"><svg viewBox="0 0 32 32"><path d="M16 5v17" stroke="#969696" stroke-width="2.5" stroke-linecap="round"/><circle cx="16" cy="26" r="5" fill="#b0b0b0" stroke="#d0d0d0" stroke-width="1.5"/><rect x="11" y="13" width="10" height="4" rx="2" fill="#d0d0d0" /><rect x="13" y="8" width="6" height="3" rx="1.5" fill="#969696"/></svg></span>Level</a>
      <a href="refer.html" role="menuitem"><span class="icon"><svg viewBox="0 0 32 32"><circle cx="16" cy="16" r="13" fill="#85e7d9" /><path d="M22.5,14h-8.7l3-3m-2.8,8a3,3,0,1,0-3,-3" stroke="#3d3d3d" stroke-width="2.3" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg></span>Refer A Friend</a>
      <a href="verify-email.html" role="menuitem"><span class="icon"><svg viewBox="0 0 32 32"><rect x="5" y="8" width="22" height="16" rx="5"/><polyline points="5,8 16,18 27,8" fill="none" stroke="#4dd3be" stroke-width="2"/><circle cx="16" cy="19" r="2.5"/></svg></span>Email Verification</a>
      <a href="help.html" role="menuitem"><span class="icon"><svg viewBox="0 0 32 32"><circle cx="16" cy="16" r="12" fill="none" stroke="#e3be23" stroke-width="2"/><text x="16" y="20" text-anchor="middle" fill="#e3be23" font-size="8" font-family="Orbitron">?</text></svg></span>Help</a>
      <a href="social-media.html" role="menuitem"><span class="icon"><svg viewBox="0 0 32 32"><circle cx="8" cy="12" r="3"/><circle cx="24" cy="12" r="3"/><circle cx="16" cy="22" r="3"/><line x1="8" y1="15" x2="16" y2="19" stroke="#b0c5e6" stroke-width="2"/><line x1="24" y1="15" x2="16" y2="19" stroke="#b0c5e6" stroke-width="2"/></svg></span>Social Media</a>
      <a href="#" id="themeSwitch" role="menuitem"><span class="icon"><svg viewBox="0 0 32 32"><circle cx="16" cy="16" r="12"/><path d="M16 4v8"/><circle cx="16" cy="16" r="5" fill="#fff"/></svg></span>Change Theme</a>
    </nav>
  </header>

  <main>
    <h1>Chat Rooms</h1>

    <div id="topBannerAd" role="presentation">
        <script type="text/javascript">
            atOptions = {
                'key' : '6e8f26946b72e000fd5de12a16765f8d',
                'format' : 'iframe',
                'height' : 90,
                'width' : 728,
                'params' : {}
            };
        </script>
        <script type="text/javascript" src="//charmingpoliteinjunction.com/6e8f26946b72e000fd5de12a16765f8d/invoke.js"></script>
    </div>
    <div id="loaderOverlay" role="alert" aria-live="assertive">
      <div class="rotator" aria-hidden="true"></div>
      Loading chat rooms...
    </div>
    <div id="roomList" role="list"></div>
    
    <div id="extraNav">
      <a href="esport-lobby.html" class="lobby-btn" id="esportLobbyBtn" role="button">
          <span>
              <svg data-lucide="zap-circle" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12A10 10 0 0 0 12 2A10 10 0 0 0 22 12A10 10 0 0 0 12 22A10 10 0 0 0 2 12Z" stroke-width="2"/><path d="M10 12L14 12M12 10L12 14" stroke-width="2"/></svg>
              ESPORT LOBBY
          </span>
      </a>
    </div>
  </main>
  

  <footer>
    <a href="privacy.html" target="_blank" rel="noopener">Privacy Policy</a>
    <a href="tou.html" target="_blank" rel="noopener">Terms of Use</a>
    <a href="contact-us.html" target="_blank" rel="noopener">Contact Us</a>
  </footer>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import {
      getFirestore,
      collection,
      query,
      where,
      onSnapshot,
      getDocs,
      doc,
      updateDoc,
      setDoc,
      serverTimestamp
    } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
    

    const firebaseConfig = {
      apiKey: "AIzaSyBGfgy9OeMTJ__oOAFxoBW-eIOYlvhObZM",
      authDomain: "sharky-chat-007.firebaseapp.com",
      projectId: "sharky-chat-007",
      storageBucket: "sharky-chat-007.appspot.com",
      messagingSenderId: "637104796242",
      appId: "1:637104796242:web:74ac36b86af91be15ea58b"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);
    

    const loaderOverlay = document.getElementById("loaderOverlay");
    const roomList = document.getElementById("roomList");
    const esportLobbyBtn = document.getElementById("esportLobbyBtn");
    let roomsLoaded = false;
    let myUsername = "";

    const menuNotif = document.getElementById("menuNotif");
    const messagesNotif = document.getElementById("messages-notif");
    
    
    function bumpBadge(el) {
      if (!el) return;
      el.style.animation = "";
      setTimeout(() => {
        el.style.animation = "notifpop .34s";
      }, 25);
    }

    function updateWalletBadge(show) {
      const walletNotif = document.getElementById("wallet-notif");
      if (!walletNotif) return;
      if (show) {
        walletNotif.textContent = "!";
        walletNotif.style.display = "inline-flex";
        bumpBadge(walletNotif);
      } else {
        walletNotif.style.display = "none";
        walletNotif.textContent = "0";
      }
    }

    function setupMenuNotifications(uid, username) {
      onSnapshot(
        query(
          collection(db, "friendRequests"),
          where("to", "==", uid),
          where("status", "==", "pending")
        ),
        (snap) => {
          const frCount = snap.size;
          const friendsNotif = document.getElementById("friends-notif");
          let msgCount = parseInt(messagesNotif.dataset.count) || 0;

          menuNotif.dataset.fr = frCount;
          friendsNotif.textContent = frCount > 99 ? "99+" : frCount;
          friendsNotif.style.display = frCount > 0 ? "inline-flex" : "none";

          const total = frCount + msgCount;
          menuNotif.textContent = total > 99 ? "99+" : total;
          menuNotif.style.display = total > 0 ? "inline-flex" : "none";

          bumpBadge(friendsNotif);
          bumpBadge(menuNotif);
        }
      );
    }

    async function setupMessageNotifications(uid, username) {
      const friendsDoc = await getDocs(collection(db, "friends"));
      let myFriends = [];
      friendsDoc.forEach((docSnap) => {
        if (docSnap.id === uid && docSnap.data()) myFriends = Object.keys(docSnap.data());
      });
      if (!myFriends.length) return;
      let unseenTracker = {};
      let usernamesData = {};
      
      const fetchUsernameChunk = async (friendIds) => {
          if (friendIds.length === 0) return;
          const chunkSnap = await getDocs(
              query(collection(db, "users"), where("__name__", "in", friendIds))
          );
          chunkSnap.forEach((d) => {
              usernamesData[d.id] = d.data().username;
          });
      };

      for (let i = 0; i < myFriends.length; i += 10) {
          await fetchUsernameChunk(myFriends.slice(i, i + 10));
      }

      for (const fid of myFriends) {
        const friendUsername = usernamesData[fid];
        if (!friendUsername || friendUsername === username) continue;
        const chatId = [username, friendUsername].sort().join("_");
        const msgRef = collection(db, "personalMessages", chatId, "messages");
        onSnapshot(
          query(
            msgRef,
            where("recipient", "==", username),
            where("seen", "==", false)
          ),
          (snap) => {
            let unseen = 0;
            snap.forEach((doc) => {
              if (doc.data().sender !== username) unseen++;
            });
            unseenTracker[chatId] = unseen;
            updateBadges();
          }
        );
      }

      function updateBadges() {
        let totalUnseen = Object.values(unseenTracker).reduce((a, b) => a + b, 0);
        const messagesNotif = document.getElementById("messages-notif");
        const menuNotif = document.getElementById("menuNotif");

        messagesNotif.dataset.count = totalUnseen;
        messagesNotif.textContent = totalUnseen > 99 ? "99+" : totalUnseen;
        messagesNotif.style.display = totalUnseen > 0 ? "inline-flex" : "none";

        const frCount = parseInt(menuNotif.dataset.fr) || 0;
        const sum = frCount + totalUnseen;

        menuNotif.textContent = sum > 99 ? "99+" : sum;
        menuNotif.style.display = sum > 0 ? "inline-flex" : "none";

        bumpBadge(messagesNotif);
        bumpBadge(menuNotif);
      }
    }

    function setupWalletNotifications(uid) {
      const notifCol = collection(db, "notifications");
      const notifQuery = query(
        notifCol,
        where("to", "==", uid),
        where("type", "==", "walletClaim"),
        where("seen", "==", false)
      );
      onSnapshot(notifQuery, (snapshot) => {
        const hasUnseen = !snapshot.empty;
        updateWalletBadge(hasUnseen);
      });
    }

    const userRef = (uid) => doc(db, "users", uid);

    async function updatePresence(uid, active) {
      if (!uid) return;
      const updateData = {
          active: active,
          lastActive: serverTimestamp() 
      };
      try {
          await updateDoc(userRef(uid), updateData);
      } catch (error) {
          if (error.code === 'not-found') {
              await setDoc(userRef(uid), updateData, { merge: true });
          }
      }
    }

    function setupPresenceListeners(uid) {
        if (!uid) return;
        
        const setInactive = () => updatePresence(uid, false);
        
        document.addEventListener('visibilitychange', () => {
            if (document.visibilityState === 'hidden') {
                updatePresence(uid, false);
            } else {
                updatePresence(uid, true);
            }
        });

        window.addEventListener('beforeunload', setInactive);
        
        setInterval(() => updatePresence(uid, true), 60000); 
    }

    const themeSwitch = document.getElementById("themeSwitch");
    function setTheme(theme) {
      if (theme === "light") {
        document.body.classList.add("light-theme");
        localStorage.setItem("sharky-chat-theme", "light");
      } else {
        document.body.classList.remove("light-theme");
        localStorage.setItem("sharky-chat-theme", "dark");
      }
    }
    function toggleTheme() {
      if(document.body.classList.contains("light-theme")) {
        setTheme("dark");
      } else {
        setTheme("light");
      }
    }
    themeSwitch.addEventListener("click", (e) => {
      e.preventDefault();
      toggleTheme();
      document.getElementById("mainHeader").classList.remove("expanded");
    });
    (() => {
      const savedTheme = localStorage.getItem("sharky-chat-theme");
      if(savedTheme === "light") {
        setTheme("light");
      } else {
        setTheme("dark");
      }
    })();


    onAuthStateChanged(auth, async (user) => {
      if (!user) {
        window.location.href = "index.html";
        return;
      }
      
      let snap = await getDocs(
        query(collection(db, "users"), where("__name__", "==", user.uid))
      );
      snap.forEach((docSnap) => {
        myUsername = docSnap.data().username || "";
      });

      setupMenuNotifications(user.uid, myUsername);
      setupMessageNotifications(user.uid, myUsername);
      setupWalletNotifications(user.uid);
      setupPresenceListeners(user.uid);

      loadChatRooms();
    });

    const mainHeader = document.getElementById("mainHeader");
    document.getElementById("menuBtn").addEventListener("click", (e) => {
      mainHeader.classList.toggle("expanded");
      e.stopPropagation();
    });
    document.querySelector(".menu-dropdown .close-btn").addEventListener("click", (e) => {
      mainHeader.classList.remove("expanded");
      e.stopPropagation();
    });
    document.addEventListener("click", (e) => {
      if (!mainHeader.contains(e.target)) mainHeader.classList.remove("expanded");
    });
    document.querySelector(".menu-dropdown").addEventListener("click", (e) => {
      if (e.target.tagName === "A") mainHeader.classList.remove("expanded");
    });


    function createFlowerAt(x, y, container) {
      const flower = document.createElement('span');
      flower.className = 'flower';
      flower.style.left = (x - 8) + 'px';
      flower.style.top = (y - 16) + 'px';
      container.appendChild(flower);
      flower.addEventListener('animationend', () => flower.remove());
    }

    async function loadChatRooms() {
      loaderOverlay.style.display = "flex";
      roomsLoaded = false;

      let roomsSnapshotUnsubscribe;

      const attemptLoad = () => {
        if (roomsSnapshotUnsubscribe) roomsSnapshotUnsubscribe();

        roomsSnapshotUnsubscribe = onSnapshot(collection(db, "chatrooms"), (snapshot) => {
          if (!roomsLoaded) {
            loaderOverlay.style.display = "none";
            roomsLoaded = true;
            esportLobbyBtn.classList.add('loaded'); 
          }
          roomList.innerHTML = "";
          if (snapshot.empty) {
            roomList.innerHTML = "<div style='color:#999999;font-size:1.09rem;margin-top:40px;text-align:center;'>No chat rooms found.</div>";
            esportLobbyBtn.classList.add('loaded'); // Ensure button is shown even if rooms are empty
            return;
          }
          
          let userCountUnsubscribes = [];

          snapshot.forEach((doc, i) => {
            const room = doc.data();
            const roomId = doc.id;
            const div = document.createElement("div");
            div.className = "room";
            div.setAttribute('role','listitem');
            div.innerHTML = `
              <i class="room-icon" data-lucide="message-circle"></i>
              <div class="room-info">
                <div class="room-title">${room.name}</div>
                <div class="user-count" id="count-${roomId}">Users: Loading...</div>
              </div>
            `;

            div.addEventListener('click', e => {
              if (div.classList.contains('room-animate-click')) return;
              div.classList.add('room-animate-click');

              const rect = div.getBoundingClientRect();
              const cx = rect.left + rect.width / 2;
              const cy = rect.top + rect.height / 2;
              for(let f = 0; f < 6; f++) {
                const angle = Math.random() * 2 * Math.PI;
                const radius = 10 + Math.random() * 10;
                const flowerX = cx + Math.cos(angle) * radius;
                const flowerY = cy + Math.sin(angle) * radius;
                createFlowerAt(flowerX, flowerY, document.body);
              }

              setTimeout(() => {
                div.classList.remove('room-animate-click');
                window.location.href = room.file || "#";
              }, 700); 
            });

            div.style.opacity = '0';
            div.style.transform = 'translateY(10px)';
            setTimeout(() => {
              div.style.transition = 'opacity 0.35s ease, transform 0.35s ease';
              div.style.opacity = '1';
              div.style.transform = 'translateY(0)';
            }, 60 * i);

            roomList.appendChild(div);

            const userRef = collection(db, `roomActiveUsers/${roomId}/users`);
            const usersSub = onSnapshot(userRef, userSnap => {
                const now = Date.now();
                let trueActive = 0;
                userSnap.forEach(userDoc => {
                  const u = userDoc.data();
              
                  if(u && u.lastSeen && u.lastSeen.toMillis && (now - u.lastSeen.toMillis() < 32000)) {
                    trueActive++;
                  }
                });
                const countEl = document.getElementById(`count-${roomId}`);
                if (countEl) {
                  countEl.textContent = `Users: ${trueActive}/${room.maxUsers || 20}`;
                }
            });
            userCountUnsubscribes.push(usersSub);
          });
          
          window.onbeforeunload = () => {
              userCountUnsubscribes.forEach(unsub => unsub());
              if (roomsSnapshotUnsubscribe) roomsSnapshotUnsubscribe();
          };

          lucide.createIcons();

        }, (err) => {
          loaderOverlay.style.display = 'none';
          roomList.innerHTML = "<div style='color:#ff5555;font-size:1.07rem;margin-top:30px;text-align:center;'>Error loading chat rooms.</div>";
          console.error("Chatrooms Load Error:", err);
        });
      };

      attemptLoad();
      
      setTimeout(() => {
        if(!roomsLoaded) loaderOverlay.style.opacity = '0';
      }, 10000);
    }
    
    esportLobbyBtn.addEventListener('click', function(e) {
        e.preventDefault();
        
        this.classList.add('lobby-btn-anim');
        
        lucide.createIcons();
        
        const targetUrl = this.href;
        
        setTimeout(() => {
            this.classList.remove('lobby-btn-anim');
            window.location.href = targetUrl;
        }, 500);
    });

  </script>

</body>
</html>