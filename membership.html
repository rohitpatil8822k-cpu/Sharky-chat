<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sharky Elite | Membership</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #05050a;
      --accent: #00d4ff;
      --gold: #fbbf24;
      --card-bg: rgba(255, 255, 255, 0.03);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background: var(--bg);
      background-image: radial-gradient(circle at 50% -20%, #1a1a3a, #05050a);
      color: #fff; font-family: 'Poppins', sans-serif;
      min-height: 100vh; padding: 40px 20px; display: flex; flex-direction: column; align-items: center;
    }

    .header h1 {
      font-family: 'Orbitron', sans-serif; font-size: 2.2rem; text-align: center;
      letter-spacing: 5px; margin-bottom: 10px;
      background: linear-gradient(to right, #fff, var(--accent), var(--gold));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      text-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
    }

    .user-info {
      background: var(--card-bg); border: 1px solid rgba(255,255,255,0.1);
      padding: 10px 25px; border-radius: 50px; margin-bottom: 40px;
      font-size: 0.9rem; backdrop-filter: blur(10px);
    }

    .grid {
      display: flex; gap: 20px; flex-wrap: wrap; justify-content: center; width: 100%; max-width: 1100px;
    }

    .card {
      background: var(--card-bg); border: 1px solid rgba(255,255,255,0.08);
      border-radius: 25px; padding: 35px 25px; width: 320px;
      transition: 0.4s; position: relative; overflow: hidden;
      display: flex; flex-direction: column;
    }

    .card:hover {
      transform: translateY(-10px); border-color: var(--accent);
      box-shadow: 0 0 30px rgba(0, 212, 255, 0.1);
    }

    .card.active { border: 2px solid var(--gold); box-shadow: 0 0 20px rgba(251, 191, 36, 0.2); }

    .card.active::before {
      content: "ACTIVE"; position: absolute; top: 15px; right: -30px;
      background: var(--gold); color: #000; font-size: 10px; font-weight: 900;
      padding: 5px 40px; transform: rotate(45deg);
    }

    .plan-icon { font-size: 3rem; margin-bottom: 15px; }
    .price { font-size: 2.2rem; font-weight: 700; margin: 15px 0; }
    .features { list-style: none; flex-grow: 1; margin-bottom: 25px; }
    .features li { font-size: 0.85rem; margin-bottom: 10px; opacity: 0.8; }

    .btn {
      width: 100%; padding: 14px; border-radius: 12px; border: none;
      font-family: 'Orbitron'; font-weight: 700; cursor: pointer; transition: 0.3s;
    }

    .btn-buy { background: var(--accent); color: #000; }
    .btn-upgrade { background: var(--gold); color: #000; }
    .btn-current { background: rgba(255,255,255,0.1); color: #fff; cursor: default; }
  </style>
</head>
<body>

  <div class="header">
    <h1>SHARKY ELITE</h1>
    <div class="user-info" id="userInfo">Syncing Sharky ID...</div>
  </div>

  <div class="grid" id="pricingGrid">
    </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getFirestore, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

    // PASTE YOUR REAL CONFIG HERE
    const firebaseConfig = {
      apiKey: "AIzaSyBGfgy9OeMTJ__oOAFxoBW-eIOYlvhObZM",
      authDomain: "sharky-chat-007.firebaseapp.com",
      projectId: "sharky-chat-007",
      storageBucket: "sharky-chat-007.appspot.com",
      messagingSenderId: "637104796242",
      appId: "1:637104796242:web:74ac36b86af91be15ea58b"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);

    onAuthStateChanged(auth, (user) => {
      if (user) {
        onSnapshot(doc(db, "users", user.uid), (snap) => {
          const userData = snap.exists() ? snap.data() : { "subscription-type": "none" };
          renderPlans(userData);
        }, (error) => {
          console.error("Firestore Error:", error);
          renderPlans({ "subscription-type": "none" }); // Error pe bhi plans dikhao
        });
      } else {
        document.getElementById("userInfo").innerHTML = "Please Login to see personalized offers";
        renderPlans({ "subscription-type": "none" });
      }
    });

    function renderPlans(userData) {
      const current = userData["subscription-type"] || "none";
      const grid = document.getElementById("pricingGrid");
      document.getElementById("userInfo").innerHTML = `Plan: <b style="color:var(--gold)">${current.toUpperCase()}</b>`;

      const plans = [
        { id: "basic", name: "BASIC", price: 1, icon: "ðŸ’Ž", perks: ["10 Coins Daily", "Basic Badge"] },
        { id: "pro", name: "PRO", price: 49, icon: "ðŸ”¥", perks: ["20 Coins Daily", "VIP Access"] },
        { id: "premium", name: "PREMIUM", price: 99, icon: "ðŸ‘‘", perks: ["50 Coins Daily", "Create Rooms"] }
      ];

      grid.innerHTML = plans.map(plan => {
        let btnText = `Get ${plan.name}`;
        let btnClass = "btn btn-buy";
        let finalAmt = plan.price;

        if (current === plan.id) {
          btnText = "Current Plan";
          btnClass = "btn btn-current";
        } 
        else if (current === "basic" && plan.id === "pro") {
          finalAmt = 19; btnText = `Upgrade for â‚¹${finalAmt}`; btnClass = "btn btn-upgrade";
        }
        else if (current === "pro" && plan.id === "premium") {
          finalAmt = 49; btnText = `Upgrade for â‚¹${finalAmt}`; btnClass = "btn btn-upgrade";
        }
        else if (current === "basic" && plan.id === "premium") {
          finalAmt = 70; btnText = `Upgrade for â‚¹${finalAmt}`; btnClass = "btn btn-upgrade";
        }

        return `
          <div class="card ${current === plan.id ? 'active' : ''}">
            <div class="plan-icon">${plan.icon}</div>
            <h2>${plan.name}</h2>
            <div class="price">â‚¹${plan.price}</div>
            <ul class="features">
              ${plan.perks.map(p => `<li>âœ¦ ${p}</li>`).join('')}
            </ul>
            <button class="${btnClass}" onclick="initiatePay('${plan.id}', ${finalAmt})">${btnText}</button>
          </div>
        `;
      }).join('');
    }

    window.initiatePay = (planId, amount) => {
      if (!auth.currentUser) return alert("Login first!");
      
      // Select link based on plan
      let link = "https://payments.cashfree.com/links?code=p9qoc816oei0_AAAAAAASErQ"; // Default test link
      if(planId === 'premium') link = "https://payments.cashfree.com/links?code=R9qoa5olaei0_AAAAAAASErQ";
      
      window.open(`${link}&customer_email=${encodeURIComponent(auth.currentUser.email)}`, "_blank");
    };
  </script>
</body>
</html>