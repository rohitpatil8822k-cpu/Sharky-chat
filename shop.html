<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0, viewport-fit=cover" />
  <title>Sharky Shop | Premium</title>
  
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700;800&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <script src="header.js" defer></script>

  <style>
    :root {
      --primary: #00d4ff; 
      --gold: #fbbf24; 
      --bg: #030712; 
      --card-bg: #111827;
      --border: rgba(255, 255, 255, 0.08); 
      --text-main: #ffffff; 
      --text-dim: #94a3b8;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    
    body { 
      background-color: var(--bg); 
      color: var(--text-main); 
      font-family: 'Outfit', sans-serif; 
      padding-top: 65px; 
      min-height: 100vh;
      overflow-x: hidden;
    }
    header, .menu-dropdown, .overlay { z-index: 9999 !important; }

    .shop-wrapper { 
      width: 100%; 
      max-width: 480px; 
      margin: 0 auto; 
      padding: 0 16px 100px; 
      position: relative; 
      z-index: 5; 
    }

    .balance-bar {
      display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin: 10px 0 25px;
    }
    .balance-card {
      display: flex; align-items: center; justify-content: center; gap: 10px;
      background: rgba(255, 255, 255, 0.04); backdrop-filter: blur(15px);
      padding: 12px; border-radius: 50px; border: 1px solid var(--border);
    }
    .coin-orb {
      width: 24px; height: 24px; border-radius: 50%; overflow: hidden; flex-shrink: 0;
    }
    .coin-orb img { width: 100%; height: 100%; object-fit: cover; }
    .balance-val { font-family: 'Orbitron'; font-weight: 800; font-size: 0.9rem; }

    .category-title { 
      font-size: 0.7rem; font-weight: 800; color: var(--primary); 
      text-transform: uppercase; letter-spacing: 2.5px; margin: 30px 0 15px 5px;
      display: flex; align-items: center; gap: 10px;
    }

    .items-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }

    .item-card { 
      background: linear-gradient(145deg, #1f2937, #111827);
      border: 1px solid var(--border); 
      border-radius: 20px; padding: 10px; display: flex; flex-direction: column;
      transition: 0.3s;
      animation: fadeIn 0.4s ease-out backwards;
    }
    .item-card img.main-thumb { width: 100%; aspect-ratio: 1/1; border-radius: 14px; margin-bottom: 8px; object-fit: cover; }
    
    .item-name { font-size: 0.6rem; font-weight: 700; color: #fff; margin-bottom: 6px; height: 28px; text-align: center; line-height: 1.2; overflow: hidden; }
    
    .price-tag { 
      display: flex; align-items: center; justify-content: center; gap: 4px; 
      font-family: 'Orbitron'; font-size: 0.7rem; color: #fff; margin-bottom: 10px;
      height: 20px;
    }
    .price-tag img { width: 14px; height: 14px; border-radius: 50%; object-fit: contain; flex-shrink: 0; }

    .buy-btn { 
      width: 100%; padding: 8px 0; border-radius: 10px; border: none; 
      font-size: 0.55rem; font-weight: 800; font-family: 'Orbitron';
      transition: 0.2s; cursor: pointer;
    }
    .btn-buy { background: var(--primary); color: #000; box-shadow: 0 4px 10px rgba(0, 212, 255, 0.2); }
    .btn-owned { background: rgba(255,255,255,0.05); color: rgba(255,255,255,0.2); cursor: default; }

    #buyPopup {
      position: fixed; inset: 0; background: rgba(0,0,0,0.9); backdrop-filter: blur(10px);
      display: flex; align-items: center; justify-content: center; z-index: 10000;
      opacity: 0; pointer-events: none; transition: 0.3s;
    }
    #buyPopup.active { opacity: 1; pointer-events: auto; }
    .popup-content {
      background: #111827; width: 85%; max-width: 300px; padding: 30px;
      border-radius: 30px; text-align: center; border: 1px solid var(--primary);
      transform: scale(0.8); transition: 0.3s;
    }
    #buyPopup.active .popup-content { transform: scale(1); }
    .popup-content img { width: 100px; height: 100px; border-radius: 20px; margin-bottom: 15px; border: 2px solid var(--primary); }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body>

  <div id="buyPopup">
    <div class="popup-content">
      <img src="" id="successImg">
      <h2 style="font-family: 'Orbitron'; font-size: 1.1rem; margin-bottom: 5px;">UNLOCKED</h2>
      <p style="color: var(--text-dim); font-size: 0.8rem; margin-bottom: 20px;">Item added to inventory.</p>
      <button class="buy-btn btn-buy" onclick="closePopup()">CONTINUE</button>
    </div>
  </div>

  <div class="shop-wrapper">
    <div class="balance-bar">
      <div class="balance-card">
        <div class="coin-orb"><img src="https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/2fcd666d-0c17-4861-bd36-3f7ff94e242c.png"></div>
        <span id="sc-count" class="balance-val">0</span>
      </div>
      <div class="balance-card">
        <div class="coin-orb"><img src="https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/7b852f75-8330-4a86-8c7c-f528de84c4de.png"></div>
        <span id="sg-count" class="balance-val">0</span>
      </div>
    </div>

    <div class="category-title"><i class="fa-solid fa-fire"></i> Profile Banners</div>
    <div id="banners-grid" class="items-grid"></div>

    <div class="category-title"><i class="fa-solid fa-award"></i> Elite Badges</div>
    <div id="badges-grid" class="items-grid"></div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import { getFirestore, doc, onSnapshot, setDoc, updateDoc, increment } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBGfgy9OeMTJ__oOAFxoBW-eIOYlvhObZM",
      authDomain: "sharky-chat-007.firebaseapp.com",
      projectId: "sharky-chat-007",
      storageBucket: "sharky-chat-007.appspot.com",
      messagingSenderId: "637104796242",
      appId: "1:637104796242:web:74ac36b86af91be15ea58b"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);

    const ITEM_LIST = {
      "banner_stars_profile": { name: "Stars Night", price: 200, cur: "sc", cat: "banner", img: "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/94c0fcfa-2a7a-46f1-ad8d-9ae08a932228.png" },
      "banner_cute_rabbit": { name: "Cute Rabbit", price: 10, cur: "sg", cat: "banner", img: "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/c4c60231-2b74-427d-8037-98f1b33227f1.png" },
      "banner_peaceful_house_3d": { name: "3D Villa", price: 15, cur: "sg", cat: "banner", img: "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/3baf3830-1a64-425c-bd6f-905bacbc84ad.png" },
      "banner_4d_illusion": { name: "4D Illusion", price: 250, cur: "sc", cat: "banner", img: "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/0704da65-dc4f-4ece-adbc-cd598182010c.png" },
      "banner_3d_luxury": { name: "3D Luxury", price: 20, cur: "sg", cat: "banner", img: "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/5d228e0c-1e37-4101-90e4-28313586a6af.png" },
      "banner_3d_moon": { name: "3D Moon", price: 220, cur: "sc", cat: "banner", img: "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/d185a9a8-660f-4396-9925-b3760299e111.png" },
      "banner_3d_gaming": { name: "3D Gaming", price: 230, cur: "sc", cat: "banner", img: "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/86b48c74-56b9-4e3d-b82c-4be753dd9234.png" },
      "banner_cartoon_one_eyed_devil": { name: "Devil Eye", price: 11, cur: "sg", cat: "banner", img: "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/c33cf83a-151b-4f56-ad81-5b2f2c4b9164.png" },
      "banner_bmw_headlight_evil": { name: "BMW Head", price: 270, cur: "sc", cat: "banner", img: "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/e3a07e8f-23af-42d5-9a5d-03f4f768ec76.png" },
      "banner_cartoon_turtle": { name: "Turtle Chill", price: 13, cur: "sg", cat: "banner", img: "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/73c882c5-e531-4b01-a356-75fdc5e4f822.png" },
      "banner_3d_rain": { name: "3D Rain", price: 190, cur: "sc", cat: "banner", img: "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/09250fbd-e0a9-4861-9251-8033325be157.png" },
      "badge_star_light": { name: "Star Light", price: 15, cur: "sg", cat: "badge", img: "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/cb7afe60-1c8e-4af6-8780-01856f63b51d.png" },
      "badge_moon_dark": { name: "Moon Dark", price: 150, cur: "sc", cat: "badge", img: "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/60a43f65-1ab7-4923-8788-758778130a22.png" },
      "badge_rising_star": { name: "Rising Star", price: 150, cur: "sc", cat: "badge", img: "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/43fb251c-b5e8-4541-a786-d91e060eb7f0.png" },
      "badge_luxury": { name: "Luxury Elite", price: 200, cur: "sc", cat: "badge", img: "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/23b9ac5c-faaf-4d14-ad52-65aab320e878.png" },
      "badge_legendary": { name: "Legendary", price: 17, cur: "sg", cat: "badge", img: "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/85b7077f-5e80-42e1-890f-ec78df6afd0e.png" },
      "badge_warrior": { name: "Warrior", price: 270, cur: "sc", cat: "badge", img: "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/8315ccb8-4f68-4dc9-b1c9-225b62ed2a87.png" },
      "badge_wolf": { name: "Wolf Badge", price: 20, cur: "sg", cat: "badge", img: "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/94674004-81f1-4aa5-afe2-15c097b29a76.png" },
      "badge_lion": { name: "Lion Badge", price: 11, cur: "sg", cat: "badge", img: "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/f026bd24-7f5b-44d8-9312-a190d6d30933.png" },
      "badge_king": { name: "The King", price: 280, cur: "sc", cat: "badge", img: "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/a07d8670-6f91-43b1-884e-79a347c3fda0.png" }
    };

    let userUID, wallet = {}, inventory = {};

    onAuthStateChanged(auth, user => {
      if(!user) return;
      userUID = user.uid;

      onSnapshot(doc(db, "wallets", userUID), s => {
        wallet = s.exists() ? s.data() : { sharkyCoin: 0, sharkyGold: 0 };
        document.getElementById("sc-count").innerText = wallet.sharkyCoin || 0;
        document.getElementById("sg-count").innerText = wallet.sharkyGold || 0;
      });

      onSnapshot(doc(db, "inventories", userUID), s => {
        inventory = s.exists() ? s.data() : {};
        render();
      });
    });

    function render() {
      const g = { banner: document.getElementById("banners-grid"), badge: document.getElementById("badges-grid") };
      g.banner.innerHTML = ""; g.badge.innerHTML = "";

      Object.entries(ITEM_LIST).forEach(([id, item]) => {
        const has = inventory[id] === true;
        const icon = item.cur === "sc" ? "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/2fcd666d-0c17-4861-bd36-3f7ff94e242c.png" : "https://user-gen-media-assets.s3.amazonaws.com/gpt4o_images/7b852f75-8330-4a86-8c7c-f528de84c4de.png";
        
        const card = document.createElement("div");
        card.className = "item-card";
        card.innerHTML = `
          <img class="main-thumb" src="${item.img}">
          <div class="item-name">${item.name}</div>
          <div class="price-tag">
            ${has ? '<span style="color:var(--text-dim);opacity:0.6;font-size:0.6rem">COLLECTED</span>' : `<img src="${icon}"> <span>${item.price}</span>`}
          </div>
          <button class="buy-btn ${has ? 'btn-owned' : 'btn-buy'}" ${has ? 'disabled' : ''}>
            ${has ? 'OWNED' : 'PURCHASE'}
          </button>`;
        if(!has) card.querySelector('button').onclick = () => buy(id, item);
        g[item.cat].appendChild(card);
      });
    }

    async function buy(id, item) {
      const k = item.cur === "sc" ? "sharkyCoin" : "sharkyGold";
      if ((wallet[k] || 0) < item.price) return alert("Not enough coins!");
      try {
        await updateDoc(doc(db, "wallets", userUID), { [k]: increment(-item.price) });
        await setDoc(doc(db, "inventories", userUID), { [id]: true }, { merge: true });
        document.getElementById("successImg").src = item.img;
        document.getElementById("buyPopup").classList.add("active");
      } catch (e) { alert("Error!"); }
    }

    window.closePopup = () => document.getElementById("buyPopup").classList.remove("active");
  </script>
</body>
</html>